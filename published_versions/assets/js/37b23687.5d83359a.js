"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9877],{28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>c});var s=n(96540);const i={},t=s.createContext(i);function o(e){const r=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:r},e.children)}},28867:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"querying/query-processing","title":"Query processing","description":"\x3c!--","source":"@site/docs/33.0.0/querying/query-processing.md","sourceDirName":"querying","slug":"/querying/query-processing","permalink":"/docs/33.0.0/querying/query-processing","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"query-processing","title":"Query processing"},"sidebar":"docs","previous":{"title":"Native queries","permalink":"/docs/33.0.0/querying/"},"next":{"title":"Query execution","permalink":"/docs/33.0.0/querying/query-execution"}}');var i=n(74848),t=n(28453);const o={id:"query-processing",title:"Query processing"},c=void 0,a={},l=[{value:"Learn more",id:"learn-more",level:2}];function u(e){const r={a:"a",h2:"h2",li:"li",ol:"ol",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.p,{children:"This topic provides a high-level overview of how Apache Druid distributes and processes queries."}),"\n",(0,i.jsx)(r.p,{children:"The general flow is as follows:"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:["A query enters the ",(0,i.jsx)(r.a,{href:"/docs/33.0.0/design/broker",children:"Broker"})," service, which identifies the segments with data that may pertain to that query. The list of segments is always pruned by time, and may also be pruned by other attributes depending on how the datasource is partitioned."]}),"\n",(0,i.jsxs)(r.li,{children:["The Broker identifies which ",(0,i.jsx)(r.a,{href:"/docs/33.0.0/design/historical",children:"Historical"})," and ",(0,i.jsx)(r.a,{href:"/docs/33.0.0/design/middlemanager",children:"Middle Manager"})," services are serving those segments and distributes a rewritten subquery to each of the services."]}),"\n",(0,i.jsx)(r.li,{children:"The Historical and Middle Manager services execute each subquery and return results to the Broker."}),"\n",(0,i.jsx)(r.li,{children:"The Broker merges the partial results to get the final answer, which it returns to the original caller."}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Druid uses time and attribute pruning to minimize the data it must scan for each query."}),"\n",(0,i.jsxs)(r.p,{children:["For filters that are more precise than what the Broker uses for pruning, the ",(0,i.jsx)(r.a,{href:"/docs/33.0.0/design/storage#indexing-and-handoff",children:"indexing structures"})," inside each segment allow Historical services to identify matching rows before accessing the data. Once the Historical service knows which rows match a particular query, it only accesses the requires rows and columns."]}),"\n",(0,i.jsx)(r.p,{children:"To maximize query performance, Druid uses the following techniques:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Pruning the set of segments accessed for a query."}),"\n",(0,i.jsx)(r.li,{children:"Within each segment, using indexes to identify which rows must be accessed."}),"\n",(0,i.jsx)(r.li,{children:"Within each segment, only reading the specific rows and columns that are relevant to a particular query."}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"learn-more",children:"Learn more"}),"\n",(0,i.jsx)(r.p,{children:"See the following topic for more information:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"/docs/33.0.0/querying/query-execution",children:"Query execution"})," to learn how Druid services process query statements."]}),"\n"]})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);