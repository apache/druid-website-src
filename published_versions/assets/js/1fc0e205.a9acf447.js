"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3727],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var d=t(96540);const r={},s=d.createContext(r);function i(e){const n=d.useContext(s);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),d.createElement(s.Provider,{value:n},e.children)}},97128:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"tutorials/tutorial-append-data","title":"Append data","description":"Learn how to append data to a datasource without changing the existing data in Apache Druid.","source":"@site/docs/33.0.0/tutorials/tutorial-append-data.md","sourceDirName":"tutorials","slug":"/tutorials/tutorial-append-data","permalink":"/docs/33.0.0/tutorials/tutorial-append-data","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"tutorial-append-data","title":"Append data","sidebar_label":"Append data","description":"Learn how to append data to a datasource without changing the existing data in Apache Druid."},"sidebar":"docs","previous":{"title":"Configure data retention","permalink":"/docs/33.0.0/tutorials/tutorial-retention"},"next":{"title":"Update data","permalink":"/docs/33.0.0/tutorials/tutorial-update-data"}}');var r=t(74848),s=t(28453);const i={id:"tutorial-append-data",title:"Append data",sidebar_label:"Append data",description:"Learn how to append data to a datasource without changing the existing data in Apache Druid."},a=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Load sample data",id:"load-sample-data",level:2},{value:"Append data",id:"append-data",level:2},{value:"Learn more",id:"learn-more",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["This tutorial shows you how to use the Apache Druid SQL ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/reference#insert",children:"INSERT"})," function to append data to a ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/design/storage",children:"datasource"})," without changing the existing data.\nThe examples in the tutorial use the ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/",children:"multi-stage query (MSQ)"})," task engine to executes SQL statements."]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.p,{children:["Before you follow the steps in this tutorial, download Druid as described in ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/tutorials/",children:"Quickstart (local)"})," and have it running on your local machine. You don't need to load any data into the Druid cluster."]}),"\n",(0,r.jsxs)(n.p,{children:["You should be familiar with data querying in Druid. If you haven't already, go through the ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/tutorials/tutorial-query",children:"Query data"})," tutorial first."]}),"\n",(0,r.jsx)(n.h2,{id:"load-sample-data",children:"Load sample data"}),"\n",(0,r.jsxs)(n.p,{children:["Load a sample dataset using ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/reference#insert",children:"INSERT"})," and ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/reference#extern-function",children:"EXTERN"})," functions. The EXTERN function lets you read external data or write to an external location."]}),"\n",(0,r.jsxs)(n.p,{children:["In the Druid ",(0,r.jsx)(n.a,{href:"/docs/33.0.0/operations/web-console",children:"web console"}),", go to the ",(0,r.jsx)(n.strong,{children:"Query"})," view and run the following query:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INSERT INTO "append_tutorial"\nSELECT\n  TIME_PARSE("timestamp") AS "__time",\n  "animal",\n  "number"\nFROM TABLE(\n  EXTERN(\n    \'{"type":"inline","data":"{\\"timestamp\\":\\"2024-01-01T07:01:35Z\\",\\"animal\\":\\"octopus\\", \\"number\\":115}\\n{\\"timestamp\\":\\"2024-01-01T05:01:35Z\\",\\"animal\\":\\"mongoose\\", \\"number\\":737}\\n{\\"timestamp\\":\\"2024-01-01T06:01:35Z\\",\\"animal\\":\\"snake\\", \\"number\\":1234}\\n{\\"timestamp\\":\\"2024-01-01T01:01:35Z\\",\\"animal\\":\\"lion\\", \\"number\\":300}\\n{\\"timestamp\\":\\"2024-01-02T07:01:35Z\\",\\"animal\\":\\"seahorse\\", \\"number\\":115}\\n{\\"timestamp\\":\\"2024-01-02T05:01:35Z\\",\\"animal\\":\\"skunk\\", \\"number\\":737}\\n{\\"timestamp\\":\\"2024-01-02T06:01:35Z\\",\\"animal\\":\\"iguana\\", \\"number\\":1234}\\n{\\"timestamp\\":\\"2024-01-02T01:01:35Z\\",\\"animal\\":\\"opossum\\", \\"number\\":300}"}\',\n      \'{"type":"json"}\'\n    )\n  ) EXTEND ("timestamp" VARCHAR, "animal" VARCHAR, "number" BIGINT)\nPARTITIONED BY DAY\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The resulting ",(0,r.jsx)(n.code,{children:"append_tutorial"})," datasource contains records for eight animals over two days.\nTo view the results, open a new tab and run the following query:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT * FROM "append_tutorial"\n'})}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:" View the results"}),(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"__time"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"animal"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"number"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T01:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lion"})}),(0,r.jsx)(n.td,{children:"300"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T05:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongoose"})}),(0,r.jsx)(n.td,{children:"737"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T06:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"snake"})}),(0,r.jsx)(n.td,{children:"1234"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T07:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"octopus"})}),(0,r.jsx)(n.td,{children:"115"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T01:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"opossum"})}),(0,r.jsx)(n.td,{children:"300"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T05:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"skunk"})}),(0,r.jsx)(n.td,{children:"737"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T06:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"iguana"})}),(0,r.jsx)(n.td,{children:"1234"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T07:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"seahorse"})}),(0,r.jsx)(n.td,{children:"115"})]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"append-data",children:"Append data"}),"\n",(0,r.jsxs)(n.p,{children:["You can use the INSERT function to append data to the datasource without changing the existing data.\nIn a new tab, run the following query to ingest and append data to the ",(0,r.jsx)(n.code,{children:"append_tutorial"})," datasource:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'INSERT INTO "append_tutorial"\nSELECT\n  TIME_PARSE("timestamp") AS "__time",\n  "animal",\n  "number"\nFROM TABLE(\n  EXTERN(\n    \'{"type":"inline","data":"{\\"timestamp\\":\\"2024-01-03T01:09:35Z\\",\\"animal\\":\\"zebra\\", \\"number\\":233}\\n{\\"timestamp\\":\\"2024-01-04T07:01:35Z\\",\\"animal\\":\\"bear\\", \\"number\\":577}\\n{\\"timestamp\\":\\"2024-01-04T05:01:35Z\\",\\"animal\\":\\"falcon\\", \\"number\\":848}\\n{\\"timestamp\\":\\"2024-01-04T06:01:35Z\\",\\"animal\\":\\"giraffe\\", \\"number\\":113}\\n{\\"timestamp\\":\\"2024-01-04T01:01:35Z\\",\\"animal\\":\\"rhino\\", \\"number\\":473}"}\',\n    \'{"type":"json"}\'\n    )\n  ) EXTEND ("timestamp" VARCHAR, "animal" VARCHAR, "number" BIGINT)\nPARTITIONED BY DAY\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Druid adds rows for the subsequent days after ",(0,r.jsx)(n.code,{children:"seahorse"}),".\nWhen the task completes, open a new tab and run the following query to view the results:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:'SELECT * FROM "append_tutorial"\n'})}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsx)("summary",{children:" View the results"}),(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"__time"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"animal"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.code,{children:"number"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T01:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"lion"})}),(0,r.jsx)(n.td,{children:"300"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T05:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"mongoose"})}),(0,r.jsx)(n.td,{children:"737"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T06:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"snake"})}),(0,r.jsx)(n.td,{children:"1234"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-01T07:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"octopus"})}),(0,r.jsx)(n.td,{children:"115"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T01:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"opossum"})}),(0,r.jsx)(n.td,{children:"300"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T05:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"skunk"})}),(0,r.jsx)(n.td,{children:"737"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T06:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"iguana"})}),(0,r.jsx)(n.td,{children:"1234"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-02T07:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"seahorse"})}),(0,r.jsx)(n.td,{children:"115"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-03T01:09:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"zebra"})}),(0,r.jsx)(n.td,{children:"233"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-04T01:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"rhino"})}),(0,r.jsx)(n.td,{children:"473"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-04T05:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"falcon"})}),(0,r.jsx)(n.td,{children:"848"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-04T06:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"giraffe"})}),(0,r.jsx)(n.td,{children:"113"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2024-01-04T07:01:35.000Z"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bear"})}),(0,r.jsx)(n.td,{children:"577"})]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"learn-more",children:"Learn more"}),"\n",(0,r.jsx)(n.p,{children:"See the following topics for more information:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/reference",children:"SQL-based ingestion reference"})," for a reference on MSQ architecture."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/33.0.0/multi-stage-query/examples",children:"SQL-based ingestion query examples"})," for example queries using the MSQ task engine."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);