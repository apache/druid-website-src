"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6502],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var a=n(96540);const i={},s=a.createContext(i);function r(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:t},e.children)}},61889:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"development/javascript","title":"JavaScript programming guide","description":"\x3c!--","source":"@site/docs/latest/development/javascript.md","sourceDirName":"development","slug":"/development/javascript","permalink":"/docs/latest/development/javascript","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"javascript","title":"JavaScript programming guide","sidebar_label":"JavaScript functionality"},"sidebar":"docs","previous":{"title":"Creating extensions","permalink":"/docs/latest/development/modules"},"next":{"title":"Build from source","permalink":"/docs/latest/development/build"}}');var i=n(74848),s=n(28453);const r={id:"javascript",title:"JavaScript programming guide",sidebar_label:"JavaScript functionality"},o=void 0,c={},l=[{value:"Examples",id:"examples",level:2},{value:"Security",id:"security",level:2},{value:"Global variables",id:"global-variables",level:2},{value:"Performance",id:"performance",level:2},{value:"JavaScript vs. Native Extensions",id:"javascript-vs-native-extensions",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"This page discusses how to use JavaScript to extend Apache Druid."}),"\n",(0,i.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(t.p,{children:"JavaScript can be used to extend Druid in a variety of ways:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/querying/aggregations#javascript-aggregator",children:"Aggregators"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/querying/dimensionspecs#javascript-extraction-function",children:"Extraction functions"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/querying/filters#javascript-filter",children:"Filters"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/querying/post-aggregations#javascript-post-aggregator",children:"Post-aggregators"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/ingestion/data-formats#javascript-parsespec",children:"Input parsers"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/design/router#javascript",children:"Router strategy"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/docs/latest/configuration/#javascript-worker-select-strategy",children:"Worker select strategy"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"JavaScript can be injected dynamically at runtime, making it convenient to rapidly prototype new functionality\nwithout needing to write and deploy Druid extensions."}),"\n",(0,i.jsx)(t.p,{children:"Druid uses the Mozilla Rhino engine at optimization level 9 to compile and execute JavaScript."}),"\n",(0,i.jsx)(t.h2,{id:"security",children:"Security"}),"\n",(0,i.jsxs)(t.p,{children:["Druid does not execute JavaScript functions in a sandbox, so they have full access to the machine. So JavaScript\nfunctions allow users to execute arbitrary code inside druid process. So, by default, JavaScript is disabled.\nHowever, on dev/staging environments or secured production environments you can enable those by setting\nthe ",(0,i.jsx)(t.a,{href:"/docs/latest/configuration/#javascript",children:"configuration property"}),"\n",(0,i.jsx)(t.code,{children:"druid.javascript.enabled = true"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"global-variables",children:"Global variables"}),"\n",(0,i.jsx)(t.p,{children:"Avoid using global variables. Druid may share the global scope between multiple threads, which can lead to\nunpredictable results if global variables are used."}),"\n",(0,i.jsx)(t.h2,{id:"performance",children:"Performance"}),"\n",(0,i.jsx)(t.p,{children:"Simple JavaScript functions typically have a slight performance penalty to native speed. More complex JavaScript\nfunctions can have steeper performance penalties. Druid compiles JavaScript functions once on each data process per query."}),"\n",(0,i.jsx)(t.p,{children:"You may need to pay special attention to garbage collection when making heavy use of JavaScript functions, especially\ngarbage collection of the compiled classes themselves. Be sure to use a garbage collector configuration that supports\ntimely collection of unused classes (this is generally easier on JDK8 with the Metaspace than it is on JDK7)."}),"\n",(0,i.jsx)(t.h2,{id:"javascript-vs-native-extensions",children:"JavaScript vs. Native Extensions"}),"\n",(0,i.jsx)(t.p,{children:"Generally we recommend using JavaScript when security is not an issue, and when speed of development is more important\nthan performance or memory use. If security is an issue, or if performance and memory use are of the utmost importance,\nwe recommend developing a native Druid extension."}),"\n",(0,i.jsx)(t.p,{children:"In addition, native Druid extensions are more flexible than JavaScript functions. There are some kinds of extensions\n(like sketches) that must be written as native Druid extensions due to their need for custom data formats."})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);