<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-release-info/release-notes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Release notes | Apache® Druid</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://druid.apache.org/img/druid_nav.png"><meta data-rh="true" name="twitter:image" content="https://druid.apache.org/img/druid_nav.png"><meta data-rh="true" property="og:url" content="https://druid.apache.org/docs/30.0.0/release-info/release-notes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Release notes | Apache® Druid"><meta data-rh="true" name="description" content="&lt;!--"><meta data-rh="true" property="og:description" content="&lt;!--"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://druid.apache.org/docs/30.0.0/release-info/release-notes"><link data-rh="true" rel="alternate" href="https://druid.apache.org/docs/30.0.0/release-info/release-notes" hreflang="en"><link data-rh="true" rel="alternate" href="https://druid.apache.org/docs/30.0.0/release-info/release-notes" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131010415-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-131010415-1",{})</script>





<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script><link rel="stylesheet" href="/assets/css/styles.4b88a1d0.css">
<link rel="preload" href="/assets/js/runtime~main.ddf452a3.js" as="script">
<link rel="preload" href="/assets/js/main.ca618e05.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/druid_nav.png" alt="Apache® Druid" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/druid_nav.png" alt="Apache® Druid" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/technology">Technology</a><a class="navbar__item navbar__link" href="/use-cases">Use Cases</a><a class="navbar__item navbar__link" href="/druid-powered">Powered By</a><a class="navbar__item navbar__link" href="/docs/30.0.0/design/">Docs</a><a class="navbar__item navbar__link" href="/community/">Community</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Apache®</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://apachecon.com/?ref=druid.apache.org" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/downloads/">Download</a><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/30.0.0/design/">Introduction to Apache Druid</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/tutorials/">Getting started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/30.0.0/design/architecture">Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/ingestion/">Ingestion</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/data-management/">Data management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/30.0.0/querying/sql">Querying</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/api-reference/">API reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;API reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/configuration/">Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/30.0.0/api-reference/automatic-compaction-api">Operations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/30.0.0/development/overview">Development</a><button aria-label="Toggle the collapsible sidebar category &#x27;Development&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/30.0.0/release-info/release-notes">Release info</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/30.0.0/release-info/release-notes">Release notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/30.0.0/release-info/upgrade-notes">Upgrade notes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/30.0.0/release-info/migration-guide">Migration guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Migration guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/30.0.0/misc/papers-and-talks">Papers</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Release info</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Release notes</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Release notes</h1></header><p>Apache Druid 30.0.0 contains over 407 new features, bug fixes, performance enhancements, documentation improvements, and additional test coverage from 50 contributors.</p><p>See the <a href="https://github.com/apache/druid/issues?q=is%3Aclosed+milestone%3A30.0.0+sort%3Aupdated-desc+" target="_blank" rel="noopener noreferrer">complete set of changes</a> for additional details, including bug fixes.</p><p>Review the <a href="#upgrade-notes">upgrade notes</a> and <a href="#incompatible-changes">incompatible changes</a> before you upgrade to Druid 30.0.0.
If you are upgrading across multiple versions, see the <a href="/docs/30.0.0/release-info/upgrade-notes">Upgrade notes</a> page, which lists upgrade notes for the most recent Druid versions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upcoming-removals">Upcoming removals<a href="#upcoming-removals" class="hash-link" aria-label="Direct link to Upcoming removals" title="Direct link to Upcoming removals">​</a></h2><p>As part of the continued improvements to Druid, we are deprecating certain features and behaviors in favor of newer iterations that offer more robust features and are more aligned with standard ANSI SQL. Many of these new features have been the default for new deployments for several releases.</p><p>The following features are deprecated, and we currently plan to remove support in Druid 32.0.0:</p><ul><li><strong>Non-SQL compliant null handling</strong>: By default, Druid now differentiates between an empty string and a record with no data as well as between an empty numerical record and <code>0</code>. For more information, see <a href="/docs/30.0.0/querying/sql-data-types#null-values">NULL values</a>. For a tutorial on the SQL-compliant logic, see the <a href="/docs/30.0.0/tutorials/tutorial-sql-null">Null handling tutorial</a>.</li><li><strong>Non-strict Boolean handling</strong>: Druid now strictly uses <code>1</code> (true) or <code>0</code> (false). Previously, true and false could be represented either as <code>true</code> and <code>false</code> or as <code>1</code> and <code>0</code>, respectively. In addition, Druid now returns a null value for Boolean comparisons like <code>True &amp;&amp; NULL</code>. For more information, see <a href="/docs/30.0.0/querying/sql-data-types#boolean-logic">Boolean logic</a>. For examples of filters that use the SQL-compliant logic, see <a href="/docs/30.0.0/querying/filters">Query filters</a>.</li><li><strong>Two-value logic</strong>: By default, Druid now uses three-valued logic for both ingestion and querying. This primarily affects filters using logical NOT operations on columns with NULL values. For more information, see <a href="/docs/30.0.0/querying/sql-data-types#boolean-logic">Boolean logic</a>. For examples of filters that use the SQL-compliant logic, see <a href="/docs/30.0.0/querying/filters">Query filters</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="important-features-changes-and-deprecations">Important features, changes, and deprecations<a href="#important-features-changes-and-deprecations" class="hash-link" aria-label="Direct link to Important features, changes, and deprecations" title="Direct link to Important features, changes, and deprecations">​</a></h2><p>This section contains important information about new and existing features.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="concurrent-append-and-replace-improvements">Concurrent append and replace improvements<a href="#concurrent-append-and-replace-improvements" class="hash-link" aria-label="Direct link to Concurrent append and replace improvements" title="Direct link to Concurrent append and replace improvements">​</a></h3><p>Streaming ingestion supervisors now support concurrent append, that is streaming tasks can run concurrently with a replace task (compaction or re-indexing) if it also happens to be using concurrent locks. Set the context parameter <code>useConcurrentLocks</code> to true to enable concurrent append.</p><p>Once you update the supervisor to have <code>&quot;useConcurrentLocks&quot;: true</code>, the transition to concurrent append happens seamlessly without causing any ingestion lag or task failures.</p><p><a href="https://github.com/apache/druid/pull/16369" target="_blank" rel="noopener noreferrer">#16369</a></p><p>Druid now performs active cleanup of stale pending segments by tracking the set of tasks using such pending segments.
This allows concurrent append and replace to upgrade only a minimal set of pending segments and thus improve performance and eliminate errors.
Additionally, it helps in reducing load on the metadata store.</p><p><a href="https://github.com/apache/druid/pull/16144" target="_blank" rel="noopener noreferrer">#16144</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grouping-on-complex-columns">Grouping on complex columns<a href="#grouping-on-complex-columns" class="hash-link" aria-label="Direct link to Grouping on complex columns" title="Direct link to Grouping on complex columns">​</a></h3><p>Druid now supports grouping on complex columns and nested arrays.
This means that both native queries and the MSQ task engine can group on complex columns and nested arrays while returning results.</p><p>Additionally, the MSQ task engine can roll up and sort on the supported complex columns, such as JSON columns, during ingestion.</p><p><a href="https://github.com/apache/druid/pull/16068" target="_blank" rel="noopener noreferrer">#16068</a>
<a href="https://github.com/apache/druid/pull/16322" target="_blank" rel="noopener noreferrer">#16322</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-zookeeper-based-segment-loading">Removed ZooKeeper-based segment loading<a href="#removed-zookeeper-based-segment-loading" class="hash-link" aria-label="Direct link to Removed ZooKeeper-based segment loading" title="Direct link to Removed ZooKeeper-based segment loading">​</a></h4><p>ZooKeeper-based segment loading is being removed due to known issues.
It has been deprecated for several releases.
Recent improvements to the Druid Coordinator have significantly enhanced performance with HTTP-based segment loading.</p><p><a href="https://github.com/apache/druid/pull/15705" target="_blank" rel="noopener noreferrer">#15705</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="improved-groupby-queries">Improved groupBy queries<a href="#improved-groupby-queries" class="hash-link" aria-label="Direct link to Improved groupBy queries" title="Direct link to Improved groupBy queries">​</a></h3><p>Before Druid pushes realtime segments to deep storage, the segments consist of spill files.
Segment metrics such as <code>query/segment/time</code> now report on each spill file for a realtime segment, rather than for the entire segment.
This change eliminates the need to materialize results on the heap, which improves the performance of groupBy queries.</p><p><a href="https://github.com/apache/druid/pull/15757" target="_blank" rel="noopener noreferrer">#15757</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="improved-and-filter-performance">Improved AND filter performance<a href="#improved-and-filter-performance" class="hash-link" aria-label="Direct link to Improved AND filter performance" title="Direct link to Improved AND filter performance">​</a></h3><p>Druid query processing now adaptively determines when children of AND filters should compute indexes and when to simply match rows during the scan based on selectivity of other filters.
Known as filter partitioning, it can result in dramatic performance increases, depending on the order of filters in the query.</p><p>For example, take a query like <code>SELECT SUM(longColumn) FROM druid.table WHERE stringColumn1 = &#x27;1000&#x27; AND stringColumn2 LIKE &#x27;%1%&#x27;</code>. Previously, Druid used indexes when processing filters if they are available.
That&#x27;s not always ideal; imagine if <code>stringColumn1 = &#x27;1000&#x27;</code> matches 100 rows. With indexes, we have to find every value of <code>stringColumn2 LIKE &#x27;%1%&#x27;</code> that is true to compute the indexes for the filter. If <code>stringColumn2</code> has more than 100 values, it ends up being worse than simply checking for a match in those 100 remaining rows.</p><p>With the new logic, Druid now checks the selectivity of indexes as it processes each clause of the AND filter.
If it determines it would take more work to compute the index than to match the remaining rows, Druid skips computing the index.</p><p>The order you write filters in a WHERE clause of a query can improve the performance of your query.
More improvements are coming, but you can try out the existing improvements by reordering a query.
Put indexes that are less intensive to compute such as <code>IS NULL</code>, <code>=</code>, and comparisons (<code>&gt;</code>, <code>&gt;=,</code> <code>&lt;</code>, and <code>&lt;=</code>) near the start of AND filters so that Druid more efficiently processes your queries.
Not ordering your filters in this way won’t degrade performance from previous releases since the fallback behavior is what Druid did previously.</p><p><a href="https://github.com/apache/druid/pull/15838" target="_blank" rel="noopener noreferrer">#15838</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="centralized-datasource-schema-alpha">Centralized datasource schema (alpha)<a href="#centralized-datasource-schema-alpha" class="hash-link" aria-label="Direct link to Centralized datasource schema (alpha)" title="Direct link to Centralized datasource schema (alpha)">​</a></h3><p>You can now configure Druid to manage datasource schema centrally on the Coordinator.
Previously, Brokers needed to query data nodes and tasks for segment schemas.
Centralizing datasource schemas can improve startup time for Brokers and the efficiency of your deployment.</p><p>To enable this feature, set the following configs:</p><ul><li>In your common runtime properties, set <code>druid.centralizedDatasourceSchema.enabled</code> to true.</li><li>If you are using MiddleManagers, you also need to set <code>druid.indexer.fork.property.druid.centralizedDatasourceSchema.enabled</code> to true in your MiddleManager runtime properties.</li></ul><p><a href="https://github.com/apache/druid/pull/15817" target="_blank" rel="noopener noreferrer">#15817</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="msq-support-for-window-functions">MSQ support for window functions<a href="#msq-support-for-window-functions" class="hash-link" aria-label="Direct link to MSQ support for window functions" title="Direct link to MSQ support for window functions">​</a></h3><p>You can now run window functions in the MSQ task engine using the context flag <code>enableWindowing:true</code>.</p><p>In the native engine, you must use a group by clause to enable window functions. This requirement is removed in the MSQ task engine.</p><p><a href="https://github.com/apache/druid/pull/15470" target="_blank" rel="noopener noreferrer">#15470</a>
<a href="https://github.com/apache/druid/pull/16229" target="_blank" rel="noopener noreferrer">#16229</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="msq-support-for-google-cloud-storage">MSQ support for Google Cloud Storage<a href="#msq-support-for-google-cloud-storage" class="hash-link" aria-label="Direct link to MSQ support for Google Cloud Storage" title="Direct link to MSQ support for Google Cloud Storage">​</a></h3><p>You can now export MSQ results to a Google Cloud Storage (GCS) path by passing the function <code>google()</code> as an argument to the <code>EXTERN</code> function.</p><p><a href="https://github.com/apache/druid/pull/16051" target="_blank" rel="noopener noreferrer">#16051</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rabbitmq-extension">RabbitMQ extension<a href="#rabbitmq-extension" class="hash-link" aria-label="Direct link to RabbitMQ extension" title="Direct link to RabbitMQ extension">​</a></h3><p>A new RabbitMQ extension is available as a community contribution.
The RabbitMQ extension (<code>druid-rabbit-indexing-service</code>) lets you manage the creation and lifetime of rabbit indexing tasks. These indexing tasks read events from <a href="https://www.rabbitmq.com" target="_blank" rel="noopener noreferrer">RabbitMQ</a> through <a href="https://www.rabbitmq.com/docs/streams#super-streams" target="_blank" rel="noopener noreferrer">super streams</a>.</p><p>As super streams allow exactly once delivery with full support for partitioning, they are compatible with Druid&#x27;s modern ingestion algorithm, without the downsides of the prior RabbitMQ firehose.</p><p>Note that this uses the RabbitMQ streams feature and not a conventional exchange. You need to make sure that your messages are in a super stream before consumption. For more information, see <a href="https://www.rabbitmq.com/docs" target="_blank" rel="noopener noreferrer">RabbitMQ documentation</a>.</p><p><a href="https://github.com/apache/druid/pull/14137" target="_blank" rel="noopener noreferrer">#14137</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functional-area-and-related-changes">Functional area and related changes<a href="#functional-area-and-related-changes" class="hash-link" aria-label="Direct link to Functional area and related changes" title="Direct link to Functional area and related changes">​</a></h2><p>This section contains detailed release notes separated by areas.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="web-console">Web console<a href="#web-console" class="hash-link" aria-label="Direct link to Web console" title="Direct link to Web console">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-the-supervisors-view">Improved the Supervisors view<a href="#improved-the-supervisors-view" class="hash-link" aria-label="Direct link to Improved the Supervisors view" title="Direct link to Improved the Supervisors view">​</a></h4><p>You can now use the <strong>Supervisors</strong> view to dynamically query supervisors and display additional information on newly added columns.</p><p><img loading="lazy" alt="Surface more information on the supervisors view" src="/assets/images/30.0.0-supervisors-93717f6a0e8e8789349b10f04709158e.png" width="1715" height="432" class="img_ev3q"></p><p><a href="https://github.com/apache/druid/pull/16318" target="_blank" rel="noopener noreferrer">#16318</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="search-in-tables-and-columns">Search in tables and columns<a href="#search-in-tables-and-columns" class="hash-link" aria-label="Direct link to Search in tables and columns" title="Direct link to Search in tables and columns">​</a></h4><p>You can now use the <strong>Query</strong> view to search in tables and columns.</p><p><img loading="lazy" alt="Use the sidebar to search in tables and columns in Query view" src="/assets/images/30.0.0-console-search-3e81d37eccd76b2563d243ad0e7d6f8b.png" width="824" height="1164" class="img_ev3q"></p><p><a href="https://github.com/apache/druid/pull/15990" target="_blank" rel="noopener noreferrer">#15990</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-input-format">Kafka input format<a href="#kafka-input-format" class="hash-link" aria-label="Direct link to Kafka input format" title="Direct link to Kafka input format">​</a></h4><p>Improved how the web console determines the input format for a Kafka source.
Instead of defaulting to the Kafka input format for a Kafka source, the web console now only picks the Kafka input format if it detects any of the following in the Kafka sample: a key, headers, or more than one topic.</p><p><a href="https://github.com/apache/druid/pull/16180" target="_blank" rel="noopener noreferrer">#16180</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-handling-of-lookups-during-sampling">Improved handling of lookups during sampling<a href="#improved-handling-of-lookups-during-sampling" class="hash-link" aria-label="Direct link to Improved handling of lookups during sampling" title="Direct link to Improved handling of lookups during sampling">​</a></h4><p>Rather than sending a transform expression containing lookups to the sampler, Druid now substitutes the transform expression with a placeholder.
This prevents the expression from blocking the flow.</p><p><img loading="lazy" alt="Change the transform expression to a placeholder" src="/assets/images/30.0.0-sampler-lookups-482179622c3ccc20196b0c44a3a781c9.png" width="1820" height="1101" class="img_ev3q"></p><p><a href="https://github.com/apache/druid/pull/16234" target="_blank" rel="noopener noreferrer">#16234</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-web-console-improvements">Other web console improvements<a href="#other-web-console-improvements" class="hash-link" aria-label="Direct link to Other web console improvements" title="Direct link to Other web console improvements">​</a></h4><ul><li><p>Added the fields <strong>Avro bytes decoder</strong> and <strong>Proto bytes decoder</strong> for their input formats <a href="https://github.com/apache/druid/pull/15950" target="_blank" rel="noopener noreferrer">#15950</a></p></li><li><p>Fixed an issue with the <a href="https://druid.apache.org/docs/latest/operations/web-console#tasks" target="_blank" rel="noopener noreferrer">Tasks</a> view returning incorrect values for <strong>Created time</strong> and <strong>Duration</strong> fields after the Overlord restarts <a href="https://github.com/apache/druid/pull/16228" target="_blank" rel="noopener noreferrer">#16228</a></p></li><li><p>Fixed the Azure icon not rendering in the web console <a href="https://github.com/apache/druid/pull/16173" target="_blank" rel="noopener noreferrer">#16173</a></p></li><li><p>Fixed the supervisor offset reset dialog in the web console <a href="https://github.com/apache/druid/pull/16298" target="_blank" rel="noopener noreferrer">#16298</a></p></li><li><p>Improved the user experience when the web console is operating in manual capabilities mode <a href="https://github.com/apache/druid/pull/16191" target="_blank" rel="noopener noreferrer">#16191</a></p></li><li><p>Improved the query timer as follows:</p><ul><li>Timer isn&#x27;t shown if an error happens</li><li>Timer resets if changing tabs while query is running</li><li>Error state is lost if tab is switched twice</li></ul><p><a href="https://github.com/apache/druid/pull/16235" target="_blank" rel="noopener noreferrer">#16235</a></p></li><li><p>The web console now suggests the <code>azureStorage</code> input type instead of the <code>azure</code> storage type <a href="https://github.com/apache/druid/pull/15820" target="_blank" rel="noopener noreferrer">#15820</a></p></li><li><p>The download query detail archive option is now more resilient when the detail archive is incomplete <a href="https://github.com/apache/druid/pull/16071" target="_blank" rel="noopener noreferrer">#16071</a></p></li><li><p>You can now set <code>maxCompactionTaskSlots</code> to zero to stop compaction tasks <a href="https://github.com/apache/druid/pull/15877" target="_blank" rel="noopener noreferrer">#15877</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="general-ingestion">General ingestion<a href="#general-ingestion" class="hash-link" aria-label="Direct link to General ingestion" title="Direct link to General ingestion">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-azure-input-source">Improved Azure input source<a href="#improved-azure-input-source" class="hash-link" aria-label="Direct link to Improved Azure input source" title="Direct link to Improved Azure input source">​</a></h4><p>You can now ingest data from multiple storage accounts using the new <code>azureStorage</code> input source schema. For example:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;ioConfig&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index_parallel&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;inputSource&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;azureStorage&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;objectGlob&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;**.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;azureStorage://storageAccount/container/prefix1/file.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;azureStorage://storageAccount/container/prefix2/file2.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;inputFormat&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://github.com/apache/druid/pull/15630" target="_blank" rel="noopener noreferrer">#15630</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="added-a-new-config-to-azureaccountconfig">Added a new config to <code>AzureAccountConfig</code><a href="#added-a-new-config-to-azureaccountconfig" class="hash-link" aria-label="Direct link to added-a-new-config-to-azureaccountconfig" title="Direct link to added-a-new-config-to-azureaccountconfig">​</a></h4><p>The new config <code>storageAccountEndpointSuffix</code> lets you configure the endpoint suffix so that you can override the default and connect to other endpoints, such as Azure Government.</p><p><a href="https://github.com/apache/druid/pull/16016" target="_blank" rel="noopener noreferrer">#16016</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-management-api-improvements">Data management API improvements<a href="#data-management-api-improvements" class="hash-link" aria-label="Direct link to Data management API improvements" title="Direct link to Data management API improvements">​</a></h4><p>Improved the <a href="https://druid.apache.org/docs/latest/api-reference/data-management-api" target="_blank" rel="noopener noreferrer">Data management API</a> as follows:</p><ul><li>Fixed a bug in the <code>markUsed</code> and <code>markUnused</code> APIs where an empty set of segment IDs would be inconsistently treated as null or non-null in different scenarios <a href="https://github.com/apache/druid/pull/16145" target="_blank" rel="noopener noreferrer">#16145</a></li><li>Improved the <code>markUnused</code> API endpoint to handle an empty list of segment versions <a href="https://github.com/apache/druid/pull/16198" target="_blank" rel="noopener noreferrer">#16198</a></li><li>The <code>segmentIds</code> filter in the Data management API payload is now parameterized in the database query <a href="https://github.com/apache/druid/pull/16174" target="_blank" rel="noopener noreferrer">#16174</a></li><li>You can now mark segments as used or unused within the specified interval using an optional list of versions.
For example: <code>(interval, [versions])</code>. When <code>versions</code> is unspecified, all versions of segments in the <code>interval</code> are marked as used or unused, preserving the old behavior <a href="https://github.com/apache/druid/pull/16141" target="_blank" rel="noopener noreferrer">#16141</a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="nested-columns-performance-improvement">Nested columns performance improvement<a href="#nested-columns-performance-improvement" class="hash-link" aria-label="Direct link to Nested columns performance improvement" title="Direct link to Nested columns performance improvement">​</a></h4><p>Nested column serialization now releases nested field compression buffers as soon as the nested field serialization is complete, which requires significantly less direct memory during segment serialization when many nested fields are present.</p><p><a href="https://github.com/apache/druid/pull/16076" target="_blank" rel="noopener noreferrer">#16076</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-task-context-reporting">Improved task context reporting<a href="#improved-task-context-reporting" class="hash-link" aria-label="Direct link to Improved task context reporting" title="Direct link to Improved task context reporting">​</a></h4><p>Added a new field <code>taskContext</code> in the task reports of non-MSQ tasks. The change is backward compatible. The payload of this field contains the entire context used by the task during its runtime.</p><p>Added a new experimental interface <code>TaskContextEnricher</code> to enrich context with use case specific logic.</p><p><a href="https://github.com/apache/druid/pull/16041" target="_blank" rel="noopener noreferrer">#16041</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-ingestion-improvements">Other ingestion improvements<a href="#other-ingestion-improvements" class="hash-link" aria-label="Direct link to Other ingestion improvements" title="Direct link to Other ingestion improvements">​</a></h4><ul><li>Added indexer level task metrics to provide more visibility in task distribution <a href="https://github.com/apache/druid/pull/15991" target="_blank" rel="noopener noreferrer">#15991</a></li><li>Added more logging detail for S3 <code>RetryableS3OutputStream</code>—<!-- -->this can help to determine whether to adjust chunk size <a href="https://github.com/apache/druid/pull/16117" target="_blank" rel="noopener noreferrer">#16117</a></li><li>Added error code to failure type <code>InternalServerError</code> <a href="https://github.com/apache/druid/pull/16186" target="_blank" rel="noopener noreferrer">#16186</a></li><li>Added a new index for pending segments table for datasource and <code>task_allocator_id</code> columns <a href="https://github.com/apache/druid/pull/16355" target="_blank" rel="noopener noreferrer">#16355</a></li><li>Fixed a bug in the <code>MarkOvershadowedSegmentsAsUnused</code> Coordinator duty to also consider segments that are overshadowed by a segment that requires zero replicas <a href="https://github.com/apache/druid/pull/16181" target="_blank" rel="noopener noreferrer">#16181</a></li><li>Fixed a bug where <code>numSegmentsKilled</code> is reported incorrectly <a href="https://github.com/apache/druid/pull/16103" target="_blank" rel="noopener noreferrer">#16103</a></li><li>Fixed a bug where completion task reports are not being generated on <code>index_parallel</code> tasks <a href="https://github.com/apache/druid/pull/16042" target="_blank" rel="noopener noreferrer">#16042</a></li><li>Fixed an issue where concurrent replace skipped intervals locked by append locks during compaction <a href="https://github.com/apache/druid/pull/16316" target="_blank" rel="noopener noreferrer">#16316</a></li><li>Improved error messages when supervisor&#x27;s checkpoint state is invalid <a href="https://github.com/apache/druid/pull/16208" target="_blank" rel="noopener noreferrer">#16208</a></li><li>Improved serialization of <code>TaskReportMap</code> <a href="https://github.com/apache/druid/pull/16217" target="_blank" rel="noopener noreferrer">#16217</a></li><li>Improved compaction segment read and published fields to include sequential compaction tasks <a href="https://github.com/apache/druid/pull/16171" target="_blank" rel="noopener noreferrer">#16171</a></li><li>Improved kill task so that it now accepts an optional list of unused segment versions to delete <a href="https://github.com/apache/druid/pull/15994" target="_blank" rel="noopener noreferrer">#15994</a></li><li>Improved logging when ingestion tasks try to get lookups from the Coordinator at startup <a href="https://github.com/apache/druid/pull/16287" target="_blank" rel="noopener noreferrer">#16287</a></li><li>Improved ingestion performance by parsing an input stream directly instead of converting it to a string and parsing the string as JSON <a href="https://github.com/apache/druid/pull/15693" target="_blank" rel="noopener noreferrer">#15693</a></li><li>Improved the creation of input row filter predicate in various batch tasks <a href="https://github.com/apache/druid/pull/16196" target="_blank" rel="noopener noreferrer">#16196</a></li><li>Improved how Druid fetches tasks from the Overlord to redact credentials <a href="https://github.com/apache/druid/pull/16182" target="_blank" rel="noopener noreferrer">#16182</a></li><li>Optimized <code>isOvershadowed</code> when there is a unique minor version for an interval <a href="https://github.com/apache/druid/pull/15952" target="_blank" rel="noopener noreferrer">#15952</a></li><li>Removed <code>EntryExistsException</code> thrown when trying to insert a duplicate task in the metadata store<!-- -->—<!-- -->Druid now throws a <code>DruidException</code> with error code <code>entryAlreadyExists</code> <a href="https://github.com/apache/druid/pull/14448" target="_blank" rel="noopener noreferrer">#14448</a></li><li>The task status output for a failed task now includes the exception message <a href="https://github.com/apache/druid/pull/16286" target="_blank" rel="noopener noreferrer">#16286</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-based-ingestion">SQL-based ingestion<a href="#sql-based-ingestion" class="hash-link" aria-label="Direct link to SQL-based ingestion" title="Direct link to SQL-based ingestion">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="manifest-files-for-msq-task-engine-exports">Manifest files for MSQ task engine exports<a href="#manifest-files-for-msq-task-engine-exports" class="hash-link" aria-label="Direct link to Manifest files for MSQ task engine exports" title="Direct link to Manifest files for MSQ task engine exports">​</a></h4><p>Export queries that use the MSQ task engine now also create a manifest file at the destination, which lists the files created by the query.</p><p>During a rolling update, older versions of workers don&#x27;t return a list of exported files, and older Controllers don&#x27;t create a manifest file.
Therefore, export queries ran during this time might have incomplete manifests.</p><p><a href="https://github.com/apache/druid/pull/15953" target="_blank" rel="noopener noreferrer">#15953</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="sortmerge-join-support"><code>SortMerge</code> join support<a href="#sortmerge-join-support" class="hash-link" aria-label="Direct link to sortmerge-join-support" title="Direct link to sortmerge-join-support">​</a></h4><p>Druid now supports <code>SortMerge</code> join for <code>IS NOT DISTINCT FROM</code> operations.</p><p><a href="https://github.com/apache/druid/pull/16003" target="_blank" rel="noopener noreferrer">#16003</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="state-of-compaction-context-parameter">State of compaction context parameter<a href="#state-of-compaction-context-parameter" class="hash-link" aria-label="Direct link to State of compaction context parameter" title="Direct link to State of compaction context parameter">​</a></h4><p>Added a new context parameter <code>storeCompactionState</code>.
When set to <code>true</code>, Druid records the state of compaction for each segment in the <code>lastCompactionState</code> segment field.</p><p><a href="https://github.com/apache/druid/pull/15965" target="_blank" rel="noopener noreferrer">#15965</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="selective-loading-of-lookups">Selective loading of lookups<a href="#selective-loading-of-lookups" class="hash-link" aria-label="Direct link to Selective loading of lookups" title="Direct link to Selective loading of lookups">​</a></h4><p>We have built the foundation of selective lookup loading. As part of this improvement, <code>KillUnusedSegmentsTask</code> no longer loads lookups.</p><p><a href="https://github.com/apache/druid/pull/16328" target="_blank" rel="noopener noreferrer">#16328</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="msq-task-report-improvements">MSQ task report improvements<a href="#msq-task-report-improvements" class="hash-link" aria-label="Direct link to MSQ task report improvements" title="Direct link to MSQ task report improvements">​</a></h4><p>Improved the task report for the MSQ task engine as follows:</p><ul><li>A new field in the MSQ task report captures the milliseconds elapsed between when the worker task was first requested and when it fully started running. Actual work time can be calculated using <code>actualWorkTimeMS = durationMs - pendingMs</code> <a href="https://github.com/apache/druid/pull/15966" target="_blank" rel="noopener noreferrer">#15966</a></li><li>A new field <code>segmentReport</code> logs the type of the segment created and the reason behind the selection <a href="https://github.com/apache/druid/pull/16175" target="_blank" rel="noopener noreferrer">#16175</a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-sql-based-ingestion-improvements">Other SQL-based ingestion improvements<a href="#other-sql-based-ingestion-improvements" class="hash-link" aria-label="Direct link to Other SQL-based ingestion improvements" title="Direct link to Other SQL-based ingestion improvements">​</a></h4><ul><li>Changed the controller checker for the MSQ task engine to check for closed only <a href="https://github.com/apache/druid/pull/16161" target="_blank" rel="noopener noreferrer">#16161</a></li><li>Fixed an incorrect check while generating MSQ task engine error report <a href="https://github.com/apache/druid/pull/16273" target="_blank" rel="noopener noreferrer">#16273</a></li><li>Improved the message you get when the MSQ task engine falls back to a broadcast join from a sort-merge <a href="https://github.com/apache/druid/pull/16002" target="_blank" rel="noopener noreferrer">#16002</a></li><li>Improved the speed of worker cancellation by bypassing unnecessary communication with the controller <a href="https://github.com/apache/druid/pull/16158" target="_blank" rel="noopener noreferrer">#16158</a></li><li>Improved the error message you get when there&#x27;s an issue with your PARTITIONED BY clause <a href="https://github.com/apache/druid/pull/15961" target="_blank" rel="noopener noreferrer">#15961</a></li><li>Runtime exceptions generated while writing frames now include the name of the column where they occurred <a href="https://github.com/apache/druid/pull/16130" target="_blank" rel="noopener noreferrer">#16130</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-ingestion">Streaming ingestion<a href="#streaming-ingestion" class="hash-link" aria-label="Direct link to Streaming ingestion" title="Direct link to Streaming ingestion">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-completion-reports">Streaming completion reports<a href="#streaming-completion-reports" class="hash-link" aria-label="Direct link to Streaming completion reports" title="Direct link to Streaming completion reports">​</a></h4><p>Streaming task completion reports now have an extra field <code>recordsProcessed</code>, which lists all the partitions processed by that task and a count of records for each partition.
Use this field to see the actual throughput of tasks and make decision as to whether you should vertically or horizontally scale your workers.</p><p><a href="https://github.com/apache/druid/pull/15930" target="_blank" rel="noopener noreferrer">#15930</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-memory-management-for-kinesis">Improved memory management for Kinesis<a href="#improved-memory-management-for-kinesis" class="hash-link" aria-label="Direct link to Improved memory management for Kinesis" title="Direct link to Improved memory management for Kinesis">​</a></h4><p>Kinesis ingestion memory tuning config is now simpler:</p><ul><li>You no longer need to set the configs <code>recordsPerFetch</code> and <code>deaggregate</code>.</li><li><code>fetchThreads</code> can no longer exceed the budgeted amount of heap (100 MB or 5%).</li><li>Use <code>recordBufferSizeBytes</code> to set a byte-based limit rather than records-based limit for the Kinesis fetch threads and main ingestion threads. We recommend setting this to 100 MB or 10% of heap, whichever is smaller.</li><li>Use <code>maxBytesPerPoll</code> to set a byte-based limit for how much data Druid polls from shared buffer at a time. Default is 1,000,000 bytes.</li></ul><p>As part of this change, the following properties have been deprecated:</p><ul><li><code>recordBufferSize</code>,  use <code>recordBufferSizeBytes</code> instead</li><li><code>maxRecordsPerPoll</code>, use <code>maxBytesPerPoll</code> instead</li></ul><p><a href="https://github.com/apache/druid/pull/15360" target="_blank" rel="noopener noreferrer">#15360</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-autoscaling-for-kinesis-streams">Improved autoscaling for Kinesis streams<a href="#improved-autoscaling-for-kinesis-streams" class="hash-link" aria-label="Direct link to Improved autoscaling for Kinesis streams" title="Direct link to Improved autoscaling for Kinesis streams">​</a></h4><p>The Kinesis autoscaler now considers max lag in minutes instead of total lag.
To maintain backwards compatibility, this change is opt-in for existing Kinesis connections.
To opt in, set <code>lagBased.lagAggregate</code> in your supervisor spec to <code>MAX</code>.
New connections use max lag by default.</p><p><a href="https://github.com/apache/druid/pull/16284" target="_blank" rel="noopener noreferrer">#16284</a>
<a href="https://github.com/apache/druid/pull/16314" target="_blank" rel="noopener noreferrer">#16314</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="parallelized-incremental-segment-creation">Parallelized incremental segment creation<a href="#parallelized-incremental-segment-creation" class="hash-link" aria-label="Direct link to Parallelized incremental segment creation" title="Direct link to Parallelized incremental segment creation">​</a></h4><p>You can now configure the number of threads used to create and persist incremental segments on the disk using the <code>numPersistThreads</code> property.
Use additional threads to parallelize the segment creation to prevent ingestion from stalling or pausing frequently as long as there are sufficient CPU resources available.</p><p><a href="https://github.com/apache/druid/pull/13982/files" target="_blank" rel="noopener noreferrer">#13982</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-steaming-supervisor-topic-improvement">Kafka steaming supervisor topic improvement<a href="#kafka-steaming-supervisor-topic-improvement" class="hash-link" aria-label="Direct link to Kafka steaming supervisor topic improvement" title="Direct link to Kafka steaming supervisor topic improvement">​</a></h4><p>Druid now properly handles previously found partition offsets.
Prior to this change, updating a Kafka streaming supervisor topic from single to multi-topic (pattern), or vice versa, could cause old offsets to be ignored spuriously.</p><p><a href="https://github.com/apache/druid/pull/16190" target="_blank" rel="noopener noreferrer">#16190</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="querying">Querying<a href="#querying" class="hash-link" aria-label="Direct link to Querying" title="Direct link to Querying">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-table-append">Dynamic table append<a href="#dynamic-table-append" class="hash-link" aria-label="Direct link to Dynamic table append" title="Direct link to Dynamic table append">​</a></h4><p>You can now use the <code>TABLE(APPEND(...))</code> function to implicitly create unions based on table schemas.</p><p>For example, the following queries are equivalent:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TABLE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">APPEND</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;table1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;table2&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;table3&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> column1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">AS</span><span class="token plain"> column2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">AS</span><span class="token plain"> column3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> table1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">AS</span><span class="token plain"> column1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">column2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">AS</span><span class="token plain"> column3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> table2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">UNION</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">ALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> column1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">column2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">column3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> table3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that if the same columns are defined with different input types, Druid uses the least restrictive column type.</p><p><a href="https://github.com/apache/druid/pull/15897" target="_blank" rel="noopener noreferrer">#15897</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="added-scalar_in_array-function">Added SCALAR_IN_ARRAY function<a href="#added-scalar_in_array-function" class="hash-link" aria-label="Direct link to Added SCALAR_IN_ARRAY function" title="Direct link to Added SCALAR_IN_ARRAY function">​</a></h4><p>Added <code>SCALAR_IN_ARRAY</code> function for checking if a scalar expression appears in an array:</p><p><code>SCALAR_IN_ARRAY(expr, arr)</code></p><p><a href="https://github.com/apache/druid/pull/16306" target="_blank" rel="noopener noreferrer">#16306</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-partitioned-by">Improved PARTITIONED BY<a href="#improved-partitioned-by" class="hash-link" aria-label="Direct link to Improved PARTITIONED BY" title="Direct link to Improved PARTITIONED BY">​</a></h4><p>If you use the MSQ task engine to run queries, you can now use the following strings in addition to the supported ISO 8601 periods:</p><ul><li><code>HOUR</code> - Same as <code>&#x27;PT1H&#x27;</code></li><li><code>DAY</code> - Same as <code>&#x27;P1D&#x27;</code></li><li><code>MONTH</code> - Same as <code>&#x27;P1M&#x27;</code></li><li><code>YEAR</code> - Same as <code>&#x27;P1Y&#x27;</code></li><li><code>ALL TIME</code></li><li><code>ALL</code> - Alias for <code>ALL TIME</code></li></ul><p><a href="https://github.com/apache/druid/pull/15836/" target="_blank" rel="noopener noreferrer">#15836</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-catalog-tables">Improved catalog tables<a href="#improved-catalog-tables" class="hash-link" aria-label="Direct link to Improved catalog tables" title="Direct link to Improved catalog tables">​</a></h4><p>You can validate complex target column types against source input expressions during DML INSERT/REPLACE operations.</p><p><a href="https://github.com/apache/druid/pull/16223" target="_blank" rel="noopener noreferrer">#16223</a></p><p>You can now define catalog tables without explicit segment granularities.
DML queries on such tables need to have the PARTITIONED BY clause specified.
Alternatively, you can update the table to include a defined segment granularity for DML queries to be validated properly.</p><p><a href="https://github.com/apache/druid/pull/16278" target="_blank" rel="noopener noreferrer">#16278</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="double-and-null-values-in-sql-type-array">Double and null values in SQL type ARRAY<a href="#double-and-null-values-in-sql-type-array" class="hash-link" aria-label="Direct link to Double and null values in SQL type ARRAY" title="Direct link to Double and null values in SQL type ARRAY">​</a></h4><p>You can now pass double and null values in SQL type ARRAY through dynamic parameters.</p><p>For example:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token property">&quot;parameters&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ARRAY&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;value&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">d1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> d2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token null keyword" style="font-style:italic">null</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://github.com/apache/druid/pull/16274" target="_blank" rel="noopener noreferrer">#16274</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="typedinfilter-filter"><code>TypedInFilter</code> filter<a href="#typedinfilter-filter" class="hash-link" aria-label="Direct link to typedinfilter-filter" title="Direct link to typedinfilter-filter">​</a></h4><p>Added a new <code>TypedInFilter</code> filter to replace <code>InDimFilter</code>—<!-- -->to improve performance when matching numeric columns.</p><p><a href="https://github.com/apache/druid/pull/16039" target="_blank" rel="noopener noreferrer">#16039</a></p><p><code>TypedInFilter</code> can run in replace-with-default mode.</p><p><a href="https://github.com/apache/druid/pull/16233" target="_blank" rel="noopener noreferrer">#16233</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="heap-dictionaries-clear-out">Heap dictionaries clear out<a href="#heap-dictionaries-clear-out" class="hash-link" aria-label="Direct link to Heap dictionaries clear out" title="Direct link to Heap dictionaries clear out">​</a></h4><p>Improved object handling to reduce the chances of running out of memory with Group By queries on high cardinality data.</p><p><a href="https://github.com/apache/druid/pull/16114" target="_blank" rel="noopener noreferrer">#16114</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-querying-improvements">Other querying improvements<a href="#other-querying-improvements" class="hash-link" aria-label="Direct link to Other querying improvements" title="Direct link to Other querying improvements">​</a></h4><ul><li>Added support for numeric arrays to window functions and subquery materializations <a href="https://github.com/apache/druid/pull/15917" target="_blank" rel="noopener noreferrer">#15917</a></li><li>Added support for single value aggregated groupBy queries for scalars <a href="https://github.com/apache/druid/pull/15700" target="_blank" rel="noopener noreferrer">#15700</a></li><li>Added support for column reordering with scan and sort style queries <a href="https://github.com/apache/druid/pull/15815" target="_blank" rel="noopener noreferrer">#15815</a></li><li>Added support for using MV_FILTER_ONLY and MV_FILTER_NONE functions with a non-literal argument <a href="https://github.com/apache/druid/pull/16113" target="_blank" rel="noopener noreferrer">#16113</a></li><li>Added the <code>radiusUnit</code> element to the <code>radius</code> bound <a href="https://github.com/apache/druid/pull/16029" target="_blank" rel="noopener noreferrer">#16029</a></li><li>Fixed the return type for the IPV4_PARSE function. The function now correctly returns null if the string literal can&#x27;t be represented as an IPv4 address <a href="https://github.com/apache/druid/pull/15916" target="_blank" rel="noopener noreferrer">#15916</a></li><li>Fixed an issue where several aggregators returned UNKNOWN or OTHER as their SQL type inference <a href="https://github.com/apache/druid/pull/16216" target="_blank" rel="noopener noreferrer">#16216</a></li><li>Fixed an issue where triggering a math expression processor on a segment that lacks a specific column results in an <code>Unable to vectorize expression</code> exception <a href="https://github.com/apache/druid/pull/16128" target="_blank" rel="noopener noreferrer">#16128</a></li><li>Fixed error while loading lookups from an empty JDBC source <a href="https://github.com/apache/druid/pull/16307" target="_blank" rel="noopener noreferrer">#16307</a></li><li>Fixed <code>ColumnType</code> to <code>RelDataType</code> conversion for nested arrays <a href="https://github.com/apache/druid/pull/16138" target="_blank" rel="noopener noreferrer">#16138</a></li><li>Fixed <code>WindowingscanAndSort</code> query issues on top of Joins <a href="https://github.com/apache/druid/pull/15996" target="_blank" rel="noopener noreferrer">#15996</a></li><li>Fixed <code>REGEXP_LIKE</code>, <code>CONTAINS_STRING</code>, and <code>ICONTAINS_STRING</code> so that they correctly return null for null value inputs in ANSI SQL compatible null handling mode (the default configuration). Previously, they returned false <a href="https://github.com/apache/druid/pull/15963" target="_blank" rel="noopener noreferrer">#15963</a></li><li>Fixed issues with <code>ARRAY_CONTAINS</code> and <code>ARRAY_OVERLAP</code> with null left side arguments as well as <code>MV_CONTAINS</code> and <code>MV_OVERLAP</code> <a href="https://github.com/apache/druid/pull/15974" target="_blank" rel="noopener noreferrer">#15974</a></li><li>Fixed an issue which can occur when using schema auto-discovery on columns with a mix of array and scalar values and querying with scan queries <a href="https://github.com/apache/druid/pull/16105" target="_blank" rel="noopener noreferrer">#16105</a></li><li>Fixed windowed aggregates so that they update the aggregation value based on the final compute <a href="https://github.com/apache/druid/pull/16244" target="_blank" rel="noopener noreferrer">#16244</a></li><li>Fixed issues with the first/last vector aggregators <a href="https://github.com/apache/druid/pull/16230" target="_blank" rel="noopener noreferrer">#16230</a></li><li>Fixed an issue where groupBy queries that have <code>bit_xor() is null</code> return the wrong result <a href="https://github.com/apache/druid/pull/16237" target="_blank" rel="noopener noreferrer">#16237</a></li><li>Fixed an issue where Broker merge buffers get into a deadlock when multiple simultaneous queries use them <a href="https://github.com/apache/druid/pull/15420" target="_blank" rel="noopener noreferrer">#15420</a></li><li>Fixed a mapping issue in window functions where two nodes get the same reference <a href="https://github.com/apache/druid/pull/16301" target="_blank" rel="noopener noreferrer">#16301</a></li><li>Improved processing of index backed OR expressions <a href="https://github.com/apache/druid/pull/16300" target="_blank" rel="noopener noreferrer">#16300</a></li><li>Improved performance for real-time queries using the MSQ task engine. Segments served by the same server are now grouped together, resulting in more efficient query handling <a href="https://github.com/apache/druid/pull/15399" target="_blank" rel="noopener noreferrer">#15399</a></li><li>Improved strict NON NULL return type checks <a href="https://github.com/apache/druid/pull/16279" target="_blank" rel="noopener noreferrer">#16279</a></li><li>Improved array handling for Booleans to account for queries such as <code>select array[true, false] from datasource</code> <a href="https://github.com/apache/druid/pull/16093" target="_blank" rel="noopener noreferrer">#16093</a></li><li>Improved how scalars work in arrays <a href="https://github.com/apache/druid/pull/16311" target="_blank" rel="noopener noreferrer">#16311</a></li><li>Improved LIKE filtering performance with multiple wildcards by not using <code>java.util.regex.Pattern</code> to match <code>%</code> <a href="https://github.com/apache/druid/pull/16153" target="_blank" rel="noopener noreferrer">#16153</a></li><li>Modified the <code>IndexedTable</code> to reject building the index on the complex types to prevent joining on complex types <a href="https://github.com/apache/druid/pull/16349" target="_blank" rel="noopener noreferrer">#16349</a></li><li>Restored <code>enableWindowing</code> context parameter for window functions <a href="https://github.com/apache/druid/pull/16229" target="_blank" rel="noopener noreferrer">#16229</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-management">Cluster management<a href="#cluster-management" class="hash-link" aria-label="Direct link to Cluster management" title="Direct link to Cluster management">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-retrieving-active-task-status">Improved retrieving active task status<a href="#improved-retrieving-active-task-status" class="hash-link" aria-label="Direct link to Improved retrieving active task status" title="Direct link to Improved retrieving active task status">​</a></h4><p>Improved performance of the Overlord API <code>/indexer/v1/taskStatus</code> by serving status of active tasks from memory rather than querying the metadata.</p><p><a href="https://github.com/apache/druid/pull/15724" target="_blank" rel="noopener noreferrer">#15724</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-cluster-management-improvements">Other cluster management improvements<a href="#other-cluster-management-improvements" class="hash-link" aria-label="Direct link to Other cluster management improvements" title="Direct link to Other cluster management improvements">​</a></h4><ul><li>Adjusted salt size for <code>Pac4jSessionStore</code> to 128 bits, which is FIPS compliant <a href="https://github.com/apache/druid/pull/15758" target="_blank" rel="noopener noreferrer">#15758</a></li><li>Improved Connection Count server select strategy to account for slow connection requests <a href="https://github.com/apache/druid/pull/15975" target="_blank" rel="noopener noreferrer">#15975</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-management">Data management<a href="#data-management" class="hash-link" aria-label="Direct link to Data management" title="Direct link to Data management">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-coordinator-default-values">Changes to Coordinator default values<a href="#changes-to-coordinator-default-values" class="hash-link" aria-label="Direct link to Changes to Coordinator default values" title="Direct link to Changes to Coordinator default values">​</a></h4><p>Changed to the default values for the Coordinator service as follows:</p><ul><li>The default value of <code>druid.coordinator.kill.period</code> has been changed from <code>P1D</code> to the runtime value of <code>druid.coordinator.period.indexingPeriod</code>. This default value can be overridden by explicitly specifying <code>druid.coordinator.kill.period</code> in the Coordinator runtime properties.</li><li>The default value for the dynamic configuration property <code>killTaskSlotRatio</code> has been updated from <code>1.0</code> to <code>0.1</code>. This ensures that kill tasks take up at least one task slot and at most 10% of all available task slots by default.</li></ul><p><a href="https://github.com/apache/druid/pull/16247" target="_blank" rel="noopener noreferrer">#16247</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="compaction-completion-reports">Compaction completion reports<a href="#compaction-completion-reports" class="hash-link" aria-label="Direct link to Compaction completion reports" title="Direct link to Compaction completion reports">​</a></h4><p>Parallel compaction task completion reports now have <code>segmentsRead</code> and <code>segmentsPublished</code> fields to show how effective a compaction task is.</p><p><a href="https://github.com/apache/druid/pull/15947" target="_blank" rel="noopener noreferrer">#15947</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="googletasklogs-upload-buffer-size"><code>GoogleTaskLogs</code> upload buffer size<a href="#googletasklogs-upload-buffer-size" class="hash-link" aria-label="Direct link to googletasklogs-upload-buffer-size" title="Direct link to googletasklogs-upload-buffer-size">​</a></h4><p>Changed the upload buffer size in <code>GoogleTaskLogs</code> to 1 MB instead of 15 MB to allow more uploads in parallel and prevent the MiddleManager service from running out of memory.</p><p><a href="https://github.com/apache/druid/pull/16236" target="_blank" rel="noopener noreferrer">#16236</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-data-management-improvements">Other data management improvements<a href="#other-data-management-improvements" class="hash-link" aria-label="Direct link to Other data management improvements" title="Direct link to Other data management improvements">​</a></h4><ul><li>Improved compaction task reports. They can now contain multiple sets of segment output reports instead of overwriting previous reports <a href="https://github.com/apache/druid/pull/15981/" target="_blank" rel="noopener noreferrer">#15981</a></li><li>Improved segment killing in Azure to be faster <a href="https://github.com/apache/druid/pull/15770" target="_blank" rel="noopener noreferrer">#15770</a></li><li>Improved the retry behavior for deep storage connections <a href="https://github.com/apache/druid/pull/15938" target="_blank" rel="noopener noreferrer">#15938</a></li><li>Improved segment creation so that all segments created in a batch have the same <code>created_date</code> entry, which can help in troubleshooting ingestion issues <a href="https://github.com/apache/druid/pull/15977" target="_blank" rel="noopener noreferrer">#15977</a></li><li>Improved how Druid parses JSON by using <code>charsetFix</code> <a href="https://github.com/apache/druid/pull/16212" target="_blank" rel="noopener noreferrer">#16212</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metrics-and-monitoring">Metrics and monitoring<a href="#metrics-and-monitoring" class="hash-link" aria-label="Direct link to Metrics and monitoring" title="Direct link to Metrics and monitoring">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-unused-segment-metric">New unused segment metric<a href="#new-unused-segment-metric" class="hash-link" aria-label="Direct link to New unused segment metric" title="Direct link to New unused segment metric">​</a></h4><p>You can now use the <code>kill/eligibleUnusedSegments/count</code> metric to find the number of unused segments of a datasource that are identified as eligible for deletion from the metadata store by the Coordinator.</p><p><a href="https://github.com/apache/druid/pull/15941" target="_blank" rel="noopener noreferrer">#15941</a> <a href="https://github.com/apache/druid/pull/15977" target="_blank" rel="noopener noreferrer">#15977</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kafka-emitter-improvements">Kafka emitter improvements<a href="#kafka-emitter-improvements" class="hash-link" aria-label="Direct link to Kafka emitter improvements" title="Direct link to Kafka emitter improvements">​</a></h4><p>You can now set custom dimensions for events emitted by the Kafka emitter as a JSON map for the <code>druid.emitter.kafka.extra.dimensions</code> property.
For example, <code>druid.emitter.kafka.extra.dimensions={&quot;region&quot;:&quot;us-east-1&quot;,&quot;environment&quot;:&quot;preProd&quot;}</code>.</p><p><a href="https://github.com/apache/druid/pull/15845" target="_blank" rel="noopener noreferrer">#15845</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="prometheus-emitter-improvements">Prometheus emitter improvements<a href="#prometheus-emitter-improvements" class="hash-link" aria-label="Direct link to Prometheus emitter improvements" title="Direct link to Prometheus emitter improvements">​</a></h4><p>The Prometheus emitter extension now emits <code>service/heartbeat</code> and <code>zk-connected</code> metrics.</p><p><a href="https://github.com/apache/druid/pull/16209" target="_blank" rel="noopener noreferrer">#16209</a></p><p>Also added the following missing metrics to the default Prometheus emitter mapping: <code>query/timeout/count</code>, <code>mergeBuffer/pendingRequests</code>, <code>ingest/events/processedWithError</code>, <code>ingest/notices/queueSize</code> and <code>segment/count</code>.</p><p><a href="https://github.com/apache/druid/pull/16329" target="_blank" rel="noopener noreferrer">#16329</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="statsd-emitter-improvements">StatsD emitter improvements<a href="#statsd-emitter-improvements" class="hash-link" aria-label="Direct link to StatsD emitter improvements" title="Direct link to StatsD emitter improvements">​</a></h4><p>You can now configure <code>queueSize</code>,<code>poolSize</code>,<code>processorWorkers</code>, and <code>senderWorkers</code> parameters for the StatsD emitter.
Use these parameters to increase the capacity of the StatsD client when its queue size is full.</p><p><a href="https://github.com/apache/druid/pull/16283" target="_blank" rel="noopener noreferrer">#16283</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-segmentunavailablecount-metric">Improved <code>segment/unavailable/count</code> metric<a href="#improved-segmentunavailablecount-metric" class="hash-link" aria-label="Direct link to improved-segmentunavailablecount-metric" title="Direct link to improved-segmentunavailablecount-metric">​</a></h4><p>The <code>segment/unavailable/count</code> metric now accounts for segments that can be queried from deep storage (<code>replicaCount=0</code>).</p><p><a href="https://github.com/apache/druid/pull/16020" target="_blank" rel="noopener noreferrer">#16020</a></p><p>Added a new metric <code>segment/deepStorage/count</code> to support the query from deep storage feature.</p><p><a href="https://github.com/apache/druid/pull/16072" target="_blank" rel="noopener noreferrer">#16072</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other-metrics-and-monitoring-improvements">Other metrics and monitoring improvements<a href="#other-metrics-and-monitoring-improvements" class="hash-link" aria-label="Direct link to Other metrics and monitoring improvements" title="Direct link to Other metrics and monitoring improvements">​</a></h4><ul><li>Added a new <code>task/autoScaler/requiredCount</code> metric that provides a count of required tasks based on the calculations of the <code>lagBased</code> autoscaler. Compare that value to <code>task/running/count</code> to discover the difference between the current and desired task counts <a href="https://github.com/apache/druid/pull/16199" target="_blank" rel="noopener noreferrer">#16199</a></li><li>Added <code>jvmVersion</code> dimension to the <code>JvmMonitor</code> module <a href="https://github.com/apache/druid/pull/16262" target="_blank" rel="noopener noreferrer">#16262</a></li><li>Exposed Kinesis lag metrics for use in alerts <a href="https://github.com/apache/druid/pull/16172" target="_blank" rel="noopener noreferrer">#16172</a></li><li>Fixed an issue with metric emission in the segment generation phase <a href="https://github.com/apache/druid/pull/16146" target="_blank" rel="noopener noreferrer">#16146</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extensions">Extensions<a href="#extensions" class="hash-link" aria-label="Direct link to Extensions" title="Direct link to Extensions">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-azure-improvements">Microsoft Azure improvements<a href="#microsoft-azure-improvements" class="hash-link" aria-label="Direct link to Microsoft Azure improvements" title="Direct link to Microsoft Azure improvements">​</a></h4><p>You can now use ingestion payloads larger than 1 MB for Azure.</p><p><a href="https://github.com/apache/druid/pull/15695" target="_blank" rel="noopener noreferrer">#15695</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-improvements">Kubernetes improvements<a href="#kubernetes-improvements" class="hash-link" aria-label="Direct link to Kubernetes improvements" title="Direct link to Kubernetes improvements">​</a></h4><p>You can now configure the CPU cores for Peons (Kubernetes jobs) using the Overlord property <code>druid.indexer.runner.cpuCoreInMicro</code>.</p><p><a href="https://github.com/apache/druid/pull/16008" target="_blank" rel="noopener noreferrer">#16008</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="delta-lake-improvements">Delta Lake improvements<a href="#delta-lake-improvements" class="hash-link" aria-label="Direct link to Delta Lake improvements" title="Direct link to Delta Lake improvements">​</a></h4><p>You can use these filters to filter out data files from a snapshot, reducing the number of files Druid has to ingest from a Delta table.</p><p>For more information, see <a href="/docs/30.0.0/ingestion/input-sources#delta-filter-object">Delta filter object</a>.</p><p><a href="https://github.com/apache/druid/pull/16288" target="_blank" rel="noopener noreferrer">#16288</a></p><p>Also added a text box for the Delta Lake filter to the web console.
The text box accepts an optional JSON object that is passed down as the <code>filter</code> to the delta input source.</p><p><a href="https://github.com/apache/druid/pull/16379" target="_blank" rel="noopener noreferrer">#16379</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improve-performance-of-ldap-credentials-validator">Improve performance of LDAP credentials validator<a href="#improve-performance-of-ldap-credentials-validator" class="hash-link" aria-label="Direct link to Improve performance of LDAP credentials validator" title="Direct link to Improve performance of LDAP credentials validator">​</a></h4><p>Improved performance of LDAP credentials validator by keeping password hashes in an in-memory cache. This helps avoid re-computation of password hashes, thus speeding up the process of LDAP-based Druid authentication.</p><p><a href="https://github.com/apache/druid/pull/15993" target="_blank" rel="noopener noreferrer">#15993</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-notes-and-incompatible-changes">Upgrade notes and incompatible changes<a href="#upgrade-notes-and-incompatible-changes" class="hash-link" aria-label="Direct link to Upgrade notes and incompatible changes" title="Direct link to Upgrade notes and incompatible changes">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-notes">Upgrade notes<a href="#upgrade-notes" class="hash-link" aria-label="Direct link to Upgrade notes" title="Direct link to Upgrade notes">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="front-coded-dictionaries">Front-coded dictionaries<a href="#front-coded-dictionaries" class="hash-link" aria-label="Direct link to Front-coded dictionaries" title="Direct link to Front-coded dictionaries">​</a></h4><p>In Druid 32.0.0, the front coded dictionaries feature will be turned on by default. Front-coded dictionaries reduce storage and improve performance by optimizing for strings where the front part looks similar.</p><p>Once this feature is on, you cannot easily downgrade to an earlier version that does not support the feature. </p><p>For more information, see <a href="/docs/30.0.0/release-info/migr-front-coded-dict">Migration guide: front-coded dictionaries</a>.</p><p>If you&#x27;re already using this feature, you don&#x27;t need to take any action. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="append-jsonpath-function">Append JsonPath function<a href="#append-jsonpath-function" class="hash-link" aria-label="Direct link to Append JsonPath function" title="Direct link to Append JsonPath function">​</a></h4><p>The <code>append</code> function for JsonPath for ORC format now fails with an exception. Previously, it would run but not append anything.</p><p><a href="https://github.com/apache/druid/pull/15772" target="_blank" rel="noopener noreferrer">#15772</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="kinesis-ingestion-tuning">Kinesis ingestion tuning<a href="#kinesis-ingestion-tuning" class="hash-link" aria-label="Direct link to Kinesis ingestion tuning" title="Direct link to Kinesis ingestion tuning">​</a></h4><p>The following properties have been deprecated as part of simplifying the memory tuning for Kinesis ingestion:</p><ul><li><code>recordBufferSize</code>,  use <code>recordBufferSizeBytes</code> instead</li><li><code>maxRecordsPerPoll</code>, use <code>maxBytesPerPoll</code> instead</li></ul><p><a href="https://github.com/apache/druid/pull/15360" target="_blank" rel="noopener noreferrer">#15360</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-supervisor-rolling-restarts">Improved Supervisor rolling restarts<a href="#improved-supervisor-rolling-restarts" class="hash-link" aria-label="Direct link to Improved Supervisor rolling restarts" title="Direct link to Improved Supervisor rolling restarts">​</a></h4><p>The <code>stopTaskCount</code> config now prioritizes stopping older tasks first. As part of this change, you must also explicitly set a value for <code>stopTaskCount</code>. It no longer defaults to the same value as <code>taskCount</code>.</p><p><a href="https://github.com/apache/druid/pull/15859" target="_blank" rel="noopener noreferrer">#15859</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-coordinator-default-values-1">Changes to Coordinator default values<a href="#changes-to-coordinator-default-values-1" class="hash-link" aria-label="Direct link to Changes to Coordinator default values" title="Direct link to Changes to Coordinator default values">​</a></h4><p>Changed the following default values for the Coordinator service:</p><ul><li>The default value for <code>druid.coordinator.kill.period</code> (if unspecified) has changed from <code>P1D</code> to the value of <code>druid.coordinator.period.indexingPeriod</code>. Operators can choose to override <code>druid.coordinator.kill.period</code> and that takes precedence over the default behavior.</li><li>The default value for the dynamic configuration property <code>killTaskSlotRatio</code> has been updated from <code>1.0</code> to <code>0.1</code>. This ensures that kill tasks take up only one task slot by default instead of consuming all available task slots.</li></ul><p><a href="https://github.com/apache/druid/pull/16247" target="_blank" rel="noopener noreferrer">#16247</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="googletasklogs-upload-buffer-size-1"><code>GoogleTaskLogs</code> upload buffer size<a href="#googletasklogs-upload-buffer-size-1" class="hash-link" aria-label="Direct link to googletasklogs-upload-buffer-size-1" title="Direct link to googletasklogs-upload-buffer-size-1">​</a></h4><p>Changed the upload buffer size in <code>GoogleTaskLogs</code> to 1 MB instead of 15 MB to allow more uploads in parallel and prevent the MiddleManager service from running out of memory.</p><p><a href="https://github.com/apache/druid/pull/16236" target="_blank" rel="noopener noreferrer">#16236</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="incompatible-changes">Incompatible changes<a href="#incompatible-changes" class="hash-link" aria-label="Direct link to Incompatible changes" title="Direct link to Incompatible changes">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="changes-to-targetdatasource-in-explain-queries">Changes to <code>targetDataSource</code> in EXPLAIN queries<a href="#changes-to-targetdatasource-in-explain-queries" class="hash-link" aria-label="Direct link to changes-to-targetdatasource-in-explain-queries" title="Direct link to changes-to-targetdatasource-in-explain-queries">​</a></h4><p>Druid 30.0.0 includes a breaking change that restores the behavior for <code>targetDataSource</code> to its 28.0.0 and earlier state, different from Druid 29.0.0 and only 29.0.0. In 29.0.0, <code>targetDataSource</code> returns a JSON object that includes the datasource name. In all other versions, <code>targetDataSource</code> returns a string containing the name of the datasource.</p><p>If you&#x27;re upgrading from any version other than 29.0.0, there is no change in behavior.</p><p>If you are upgrading from 29.0.0, this is an incompatible change.</p><p><a href="https://github.com/apache/druid/pull/16004" target="_blank" rel="noopener noreferrer">#16004</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-zookeeper-based-segment-loading-1">Removed ZooKeeper-based segment loading<a href="#removed-zookeeper-based-segment-loading-1" class="hash-link" aria-label="Direct link to Removed ZooKeeper-based segment loading" title="Direct link to Removed ZooKeeper-based segment loading">​</a></h4><p>ZooKeeper-based segment loading is being removed due to known issues.
It has been deprecated for several releases.
Recent improvements to the Druid Coordinator have significantly enhanced performance with HTTP-based segment loading.</p><p><a href="https://github.com/apache/druid/pull/15705" target="_blank" rel="noopener noreferrer">#15705</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="removed-coordinator-configs">Removed Coordinator configs<a href="#removed-coordinator-configs" class="hash-link" aria-label="Direct link to Removed Coordinator configs" title="Direct link to Removed Coordinator configs">​</a></h4><p>Removed the following Coordinator configs:</p><ul><li><code>druid.coordinator.load.timeout</code>: Not needed as the default value of this parameter (15 minutes) is known to work well for all clusters.</li><li><code>druid.coordinator.loadqueuepeon.type</code>: Not needed as this value is always <code>http</code>.</li><li><code>druid.coordinator.curator.loadqueuepeon.numCallbackThreads</code>: Not needed as ZooKeeper(curator)-based segment loading isn&#x27;t an option anymore.</li></ul><p>Auto-cleanup of compaction configs of inactive datasources is now enabled by default.</p><p><a href="https://github.com/apache/druid/pull/15705" target="_blank" rel="noopener noreferrer">#15705</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="changed-usemaxmemoryestimates-for-hadoop-jobs">Changed <code>useMaxMemoryEstimates</code> for Hadoop jobs<a href="#changed-usemaxmemoryestimates-for-hadoop-jobs" class="hash-link" aria-label="Direct link to changed-usemaxmemoryestimates-for-hadoop-jobs" title="Direct link to changed-usemaxmemoryestimates-for-hadoop-jobs">​</a></h4><p>The default value of the <code>useMaxMemoryEstimates</code> parameter for Hadoop jobs is now <code>false</code>.</p><p><a href="https://github.com/apache/druid/pull/16280" target="_blank" rel="noopener noreferrer">#16280</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="developer-notes">Developer notes<a href="#developer-notes" class="hash-link" aria-label="Direct link to Developer notes" title="Direct link to Developer notes">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="dependency-updates">Dependency updates<a href="#dependency-updates" class="hash-link" aria-label="Direct link to Dependency updates" title="Direct link to Dependency updates">​</a></h4><p>The following dependencies have had their versions bumped:</p><ul><li>Updated Azure POM from 1.2.19 to 1.2.23 to update transitive dependency <code>nimbus-jose-jwt</code> to address <code>CVE-2023-52428</code> <a href="https://github.com/apache/druid/pull/16374" target="_blank" rel="noopener noreferrer">#16374</a></li><li>Updated <code>commons-configuration2</code> from 2.8.0 to 2.10.1 to address <code>CVE-2024-29131</code> and <code>CVE-2024-29133</code> <a href="https://github.com/apache/druid/pull/16374" target="_blank" rel="noopener noreferrer">#16374</a></li><li>Updated <code>bcpkix-jdk18on</code> from 1.76 to 1.78.1 to address <code>CVE-2024-30172</code>, <code>CVE-2024-30171</code>, and <code>CVE-2024-29857</code> <a href="https://github.com/apache/druid/pull/16374" target="_blank" rel="noopener noreferrer">#16374</a></li><li>Updated <code>nimbus-jose-jwt</code> from 8.22.1 to 9.37.2 <a href="https://github.com/apache/druid/pull/16320" target="_blank" rel="noopener noreferrer">#16320</a></li><li>Updated <code>rewrite-maven-plugin</code> from 5.23.1 to 5.27.0 <a href="https://github.com/apache/druid/pull/16238" target="_blank" rel="noopener noreferrer">#16238</a></li><li>Updated <code>rewrite-testing-frameworks</code> from 2.4.1 to 2.6.0 <a href="https://github.com/apache/druid/pull/16238" target="_blank" rel="noopener noreferrer">#16238</a></li><li>Updated <code>json-path</code> from 2.3.0 to 2.9.0</li><li>Updated Apache Delta Lake from 3.0.0 to 3.1.0</li><li>Updated Netty to <code>4.1.108.Final</code> to address <code>CVE-2024-29025</code> <a href="https://github.com/apache/druid/pull/16267" target="_blank" rel="noopener noreferrer">#16267</a></li><li>Updated Apache ZooKeeper to 3.8.4 to address <code>CVE-2024-23944</code> <a href="https://github.com/apache/druid/pull/16267" target="_blank" rel="noopener noreferrer">#16267</a></li><li>Updated <code>log4j.version</code> from 2.18.0 to 2.22.1 <a href="https://github.com/apache/druid/pull/15934" target="_blank" rel="noopener noreferrer">#15934</a></li><li>Updated <code>org.apache.commons.commons-compress</code> from 1.24.0 to 1.26.0 <a href="https://github.com/apache/druid/pull/16009" target="_blank" rel="noopener noreferrer">#16009</a></li><li>Updated <code>org.apache.commons.commons-codec</code> from 1.16.0 to 1.16.1 <a href="https://github.com/apache/druid/pull/16009" target="_blank" rel="noopener noreferrer">#16009</a></li><li>Updated <code>org.bitbucket.b_c:jose4j</code> from 0.9.3 to 0.9.6 <a href="https://github.com/apache/druid/pull/16078" target="_blank" rel="noopener noreferrer">#16078</a></li><li>Updated <code>redis.clients:jedis</code> from 5.0.2 to 5.1.2 <a href="https://github.com/apache/druid/pull/16074" target="_blank" rel="noopener noreferrer">#16074</a></li><li>Updated Jetty from <code>9.4.53.v20231009</code> to <code>9.4.54.v20240208</code> <a href="https://github.com/apache/druid/pull/16000" target="_blank" rel="noopener noreferrer">#16000</a></li><li>Updated <code>webpackdevmiddleware</code> from 5.3.3 to 5.3.4 in web console <a href="https://github.com/apache/druid/pull/16195" target="_blank" rel="noopener noreferrer">#16195</a></li><li>Updated <code>express</code> from 4.18.2 to 4.19.2 in web console <a href="https://github.com/apache/druid/pull/16204" target="_blank" rel="noopener noreferrer">#16204</a></li><li>Updated <code>druid-toolkit/query</code> from 0.21.9 to 0.22.11 in web console <a href="https://github.com/apache/druid/pull/16213" target="_blank" rel="noopener noreferrer">#16213</a></li><li>Updated <code>follow-redirects</code> from 1.15.1 to 1.15.4 in web console <a href="https://github.com/apache/druid/pull/16134" target="_blank" rel="noopener noreferrer">#16134</a></li><li>Updated Axios from 0.26.1 to 0.28.0 in web console <a href="https://github.com/apache/druid/pull/16087" target="_blank" rel="noopener noreferrer">#16087</a></li><li>Removed the <code>aws-sdk</code> transitive dependency to reduce the size of the compiled Ranger extension <a href="https://github.com/apache/druid/pull/16011" target="_blank" rel="noopener noreferrer">#16011</a></li><li>Removed end of life <code>log4j v1</code> dependencies <a href="https://github.com/apache/druid/pull/15984" target="_blank" rel="noopener noreferrer">#15984</a></li><li>Suppressed errors for the following CVEs: <code>CVE-2023-52428(7.5)</code>, <code>CVE-2023-50291(7.5)</code>, <code>CVE-2023-50298(7.5)</code>, <code>CVE-2023-50386(8.8)</code>, and <code>CVE-2023-50292(7.5)</code> <a href="https://github.com/apache/druid/pull/16147" target="_blank" rel="noopener noreferrer">#16147</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/30.0.0/development/experimental"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Experimental features</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/30.0.0/release-info/upgrade-notes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Upgrade notes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#upcoming-removals" class="table-of-contents__link toc-highlight">Upcoming removals</a></li><li><a href="#important-features-changes-and-deprecations" class="table-of-contents__link toc-highlight">Important features, changes, and deprecations</a><ul><li><a href="#concurrent-append-and-replace-improvements" class="table-of-contents__link toc-highlight">Concurrent append and replace improvements</a></li><li><a href="#grouping-on-complex-columns" class="table-of-contents__link toc-highlight">Grouping on complex columns</a></li><li><a href="#improved-groupby-queries" class="table-of-contents__link toc-highlight">Improved groupBy queries</a></li><li><a href="#improved-and-filter-performance" class="table-of-contents__link toc-highlight">Improved AND filter performance</a></li><li><a href="#centralized-datasource-schema-alpha" class="table-of-contents__link toc-highlight">Centralized datasource schema (alpha)</a></li><li><a href="#msq-support-for-window-functions" class="table-of-contents__link toc-highlight">MSQ support for window functions</a></li><li><a href="#msq-support-for-google-cloud-storage" class="table-of-contents__link toc-highlight">MSQ support for Google Cloud Storage</a></li><li><a href="#rabbitmq-extension" class="table-of-contents__link toc-highlight">RabbitMQ extension</a></li></ul></li><li><a href="#functional-area-and-related-changes" class="table-of-contents__link toc-highlight">Functional area and related changes</a><ul><li><a href="#web-console" class="table-of-contents__link toc-highlight">Web console</a></li><li><a href="#general-ingestion" class="table-of-contents__link toc-highlight">General ingestion</a></li><li><a href="#sql-based-ingestion" class="table-of-contents__link toc-highlight">SQL-based ingestion</a></li><li><a href="#streaming-ingestion" class="table-of-contents__link toc-highlight">Streaming ingestion</a></li><li><a href="#querying" class="table-of-contents__link toc-highlight">Querying</a></li><li><a href="#cluster-management" class="table-of-contents__link toc-highlight">Cluster management</a></li><li><a href="#data-management" class="table-of-contents__link toc-highlight">Data management</a></li><li><a href="#metrics-and-monitoring" class="table-of-contents__link toc-highlight">Metrics and monitoring</a></li><li><a href="#extensions" class="table-of-contents__link toc-highlight">Extensions</a></li></ul></li><li><a href="#upgrade-notes-and-incompatible-changes" class="table-of-contents__link toc-highlight">Upgrade notes and incompatible changes</a><ul><li><a href="#upgrade-notes" class="table-of-contents__link toc-highlight">Upgrade notes</a></li><li><a href="#incompatible-changes" class="table-of-contents__link toc-highlight">Incompatible changes</a></li><li><a href="#developer-notes" class="table-of-contents__link toc-highlight">Developer notes</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/favicon.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/favicon.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright © 2023 Apache Software Foundation. Except where otherwise noted, licensed under CC BY-SA 4.0. Apache Druid, Druid, and the Druid logo are either registered trademarks or trademarks of The Apache Software Foundation in the United States and other countries.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ddf452a3.js"></script>
<script src="/assets/js/main.ca618e05.js"></script>
</body>
</html>